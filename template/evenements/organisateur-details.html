{% extends "include/main.html" %}

{% if saison %}
{% block meta-description %}{{ evenement.meta_description }}{% endblock %}

{% load filtres %}
{% load aidetag %}
{% load eventFilters %}
{% load tz %}

{% block contenu %}

<div itemscope itemtype="http://schema.org/Event" class="container"style="margin-top: 60px;">
	<div  class="row-fluid">
			<div class="span12">
			<ul class="breadcrumb">
					<li><a href="/">Accueil</a></li> <span class="divider">/</span></li>
					<li><a href="{% url evenements.views.AgendaGlobal %}">Agenda</a> <span class="divider">/</span></li>
				
			</ul>	
			</div>	
			<div class="span7">
				
				
				
				<h1 itemprop="name"><a itemprop="url" href="{% url evenements.views.EvenementDetailsHtml slug=saison.slug evenement_slug=evenement.slug%}">{{ evenement.nom }}</a></h1>
				
				
				{% if evenement.image %}
				<img class="img-polaroid" alt="{{ orga.nom }}" src="{{ orga.logo|resize:'670x375x1' }}">
				{% endif %}
	
					<div itemprop="description">
						{{ orga.description|safe }}
					</div>
				
				{% if orga.url != "" %}
				<p>
					Plus d'informations sur ce site : <a href="{{ orga.url }}">{{orga.nom}}</a>
				</p>
				{% endif %}
				
			</div>
			<div class="span4">
				<br/>
				<address>
					<div itemprop="location" itemscope itemtype="http://schema.org/Place">
					<div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
								
								<strong>{{ orga.nom }}</strong><br/>
								<span itemprop="streetAddress" >{{ orga.rue }}</span><br/>
								<span>{{ orga.ville.code_postal }}</span> <span itemprop="addressLocality" >{{ orga.ville.nom }}</span><br/>
								<span><abbr title="Téléphone">Tel</abbr>: {{ orga.telephone }}</span><br/>

					</div>
					</div>
				</address>
				<hr/>
		<p style="text-align: center;">
		{{evenement|calendaraddlinklist|safe}}
		
		{{"ical"|aide}}
		</p>
		<hr class="hidden-phone" />
		    <p class="hidden-phone" style="text-align: center;">   
		    	Ajouter cet evènement à votre agenda : <br/>(Format QR Code) : <br/>
					<img alt="QrCode : {{ evenement.nom }}" src="data:image/png;base64,{{ evenement_qr }}"/>
					<br/>
					{{"qr-code"|aide}}
			</p>
		</div>
	
	</div>
	<div class="row-fluid">
		<div class="span7">
			<hr/>
			<h2>Géolocalisation: <small>{{evenement.lieu.rue}}, {{evenement.lieu.ville.code_postal}} {{evenement.lieu.ville.nom }}</small></h2>
			<div id="map_canvas" style="width: 512px; height: 450px"></div>

		</div>

		<div class="span4">
			<hr/>
			<span itemprop="geo" itemscope itemtype="http://data-vocabulary.org/​GeoCoordinates">
				<meta itemprop="latitude" content="{{ evenement.lieu.latitude }}" />
				<meta itemprop="longitude" content="{{ evenement.lieu.longitude }}" />
			</span>
			
			<p style="text-align: center;">
				Les coordonnées GPS :<br/> 
				Latitude : {{ evenement.lieu.latitude }} <br/> 
				Longitude : {{ evenement.lieu.longitude }}
			</p>
			<hr class="hidden-phone" />
		    	<p class="hidden-phone" style="text-align: center;">
			    Les coordonnées GPS : <br/>(Format QR Code)<br/>
			    <img alt="QrCode : {{ each.nom }}" src="data:image/png;base64,{{ localisation_qr }}"/>
			    
			    {{"qr-code"|aide}}
			    
			    </p>
			<br/>
		</div>
		
	</div>
       {% if tarifs %}
		<div class="row-fluid">
			<div class="span7">
				<hr/>
				<h2>Tarification :</h2>
				<ul>
					{% for each in tarifs.prix.all %}
					<li>
						{{ each.nom }} : {{ each.prix }}
					</li>
					{% endfor %}
				</ul>
			</div>

		</div>
		{% endif %}
</div>

{% endblock %}
{% else %}
<p>
	Erreur interne.
</p>
{% endif %}

{% block jsload%}

<script src="/static/js/jquery/jquery-1.8.1.min.js"></script>
<script src="/static/bootstrap/js/bootstrap.js"></script>

<script>
	function LoadMap() {
		var tabEquipement = Array();
		var myMarker = Object();
		myMarker['longitude'] ={{evenement.lieu.longitude|toFloatjs}}  ;
		myMarker['latitude'] ={{evenement.lieu.latitude|toFloatjs}};
		myMarker['description'] = '{{evenement.lieu.nom }} - {{evenement.lieu.ville.nom }}';
		myMarker['marker'] = '{{evenement.lieu|lieuMarker }}';
		tabEquipement.push(myMarker);
		setMarkers(tabEquipement);
		map_init();

	}

	$(window).resize(function() {
		var h = $('#map_canvas').parent().width();
		$('#map_canvas').css('height', (h));
		$('#map_canvas').css('width', (h));
	}).resize();

</script>

<script src="/static/js/openstreetmap/OpenLayers.js"></script>
<script src="/static/js/openstreetmap/lib/OpenLayers/Lang/fr.js"></script>
<script src="http://maps.google.com/maps/api/js?v=3&amp;sensor=false"></script>
<script src="/static/js/map/osm-fonction.js"></script>
{% endblock%}
